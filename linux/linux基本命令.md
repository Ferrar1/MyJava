完整信息查看doc文件，这里只是记录基本信息
## 对终端中光标的操作：
- Ctrl+a 光标移动到开始位置
- Ctrl+e 光标移动到最末尾
- Ctrl+k 删除此处至末尾的所有内容
- Ctrl+u 删除此处至开始的所有内容
- Ctrl+l 相当于clear，即清屏
- Ctrl+d 关闭终端

## 常识
1、绝对路径从/开始，不需要参照物，在哪都行：ls /root。相对路径：./就是当前路径，../上一级目录下。

2、linux文件目录
![image text](https://github.com/xuzhuang1996/MyJava/blob/master/img/linux/linux1.png)
![image text](https://github.com/xuzhuang1996/MyJava/blob/master/img/linux/Linux2.png)

3. 在Linux系统中,一切设备都看作文件。而每打开一个文件,就有一个代表该打开文件的文件描述符。程序启动时默认打开三个I/O设备文件:标准输入文件stdin,标准输出文件stdout,标准错误输出文件stderr,分别得到文件描述符0,1,2：
   - 文件描述符0：标准输入文件stdin
   - 文件描述符1：标准输出文件stdout
   - 文件描述符2：标准错误输出文件stderr

## 基础指令
1、ls

- `ls`——list列出当前路径下的所有文件以及文件夹名称
- `ls 路径`——指定路径下的所有文件文件夹名称。
- `ls -l 路径`——即-l表示list，以详细列表形式进行展示.
- `ls -la 路径`——显示所有文件文件夹，包括隐藏文件（隐藏文件以.开头）
- `ls -lh 路径`——以列表的形式且显示文件大小的时候以可读性较高的形式显示（所有目录都显示4k，但不代表他就是4k）

2、pwd

- `pwd`——print working directory打印当前工作目录

3、mkdir

- `mkdir -p 路径` ——`-p`没有路径就创建一个

4、touch 

- `touch 路径`——创建文件

5、cp

- `cp 被复制的文档路径 目的路径`——copy，
- `cp -r 被复制的文档路径 目的路径`——如果进行文件夹的复制，需要加-r(递归)

6、 mv

- `mv 需要移动的文档路径 目的路径`——move剪切,跟重命名用法一样

7、rm

- `rm 选项 需要移除的文档路径`——remove删除
- `rm -f 路径`——强制删除force，不需要y确认
- `rm -rf 路径`——强制删除目录。路径中lin*(使用通配符来删除，以lin开头)

8、输出重定向：将命令的输出结果保存到文件中。

- `>`覆盖输出
- `>>`追加输出

9、cat

- `cat 文件路径`——直接打开文件，不编辑，直接退出了。与vim不同。
- `cat 待合并文件1 待合并文件n  >  合并后路径`——可以用来合并文件。

10、Linux中的打包文件一般是以.tar结尾的，压缩的命令一般是以.gz结尾的。而一般情况下打包和压缩是一起进行的，打包并压缩后的文件的后缀名一般.tar.gz

- `tar -zcvf 打包压缩后的文件名 要打包压缩的文件 `——打包并压缩文件
   - z：调用gzip压缩命令进行压缩 
   - c：打包文件 
   - v：显示运行过程 
   - f：指定文件名 
- `tar [-zxvf] 压缩文件`——解压压缩包
   - x：代表解压
   - z:可以不写，自动识别压缩方式
   - 之前都是直接命名，现在有`tar -xvf xxx.tar.gz -C /usr`——C代表指定解压的位置
   
11、sed

Sed主要用来自动编辑一个或多个文件；简化对文件的反复操作；编写转换程序等。语法：`sed [-hnV][-e<script>][-f<script文件>][文本文件]`，其中

- -h或--help 显示帮助。
- -n或--quiet或--silent 仅显示script处理后的结果。
- -V或--version 显示版本信息。
- -e<script>或--expression=<script> 以选项中指定的script来处理输入的文本文件。
- -f<script文件>或--file=<script文件> 以选项中指定的script文件来处理输入的文本文件。

上诉script脚本中，可以写入：

- a ：新增， a 的后面可以接字串，而这些字串会在新的一行出现(目前的下一行)，例：`sed -e 4a\newLine testfile`,第四行后添加一行。
- c ：取代， c 的后面可以接字串，这些字串可以取代 n1,n2 之间的行！
- d ：删除，因为是删除啊，所以 d 后面通常不接任何咚咚；
- i ：插入， i 的后面可以接字串，而这些字串会在新的一行出现(目前的上一行)；
- p ：打印，亦即将某个选择的数据印出。通常 p 会与参数 sed -n 一起运行,例：`sed -n '300,500p' file1`——查看file1文件的第300-500行。
- s ：取代，可以直接进行取代的工作哩！通常这个 s 的动作可以搭配正规表示法！例如 1,20s/old/new/g 就是啦！

## 进阶
1、df

- `df -h` ——查看磁盘空间。-h可读性

2、free

- `free -m`—— 查看内存使用情况(m是兆，-g也可以)。

> 在内存小于2G的情况下，交换分区swap应为内存的2倍，超过2G的话，交换分区为物理内存加上2G

3、head

- `head -n 路径`——查看文件的前n行。默认10行。n为数字

4、tail

- `tail -n 路径`——显示后n行
- `tail -f 路径`——查看一个文件的动态变化（必须系统自己加的而不是人为加的）
- `tail -n k`——打印最后k行。
- `tail -n +k`——从k行开始打印到最后一行。

>`cat file1 | tail -n +300 | head -n 200`,该命令，前面是打印从300到末行，后面是说打印前200行，而从300开始的200行为300-499.这才是结果

5、less

- `less 路径`——查看文件，以较少的内容输出，按下辅助功能键输出更多：输入20：从20显示

6、wc

- `wc -lwc 路径`——l(line)行数w(word)单词数c(byte)字节数，统计文件信息

7、管道`|`(记住不能是中文的|)

- `ls /|grep y`——查询目录下包含y字母的文档（|前面的输出就是后面的输入，grep过滤
- find是根据name, ctime, mtime等信息搜索文件的命令，不会根据文件内容去检索，也就是它只利用了iNode的信息
- grep可以搜索包含xx字符串的文件，根据文件内容来，`grep -Rn "mrtg" /usr/local`

## 高级
1、hostname

- `hostname -f`——输出主机名FQDN，全限定域名,直接输出localhost这种
- `hostname`——输出完整主机名

2、id

- `id` ——默认显示当前用户信息

3、whoami

- `whoami`——显示当前用户名（一般用于shell脚本，方便记录日志）

4、ps

- `ps  -ef`——查看当前服务器的进程信息。-e(=-A)列出全部进程。-f显示全字段（属性）
- `jobs`-查看后台进程作业，如果后台没有就啥也不显示

5、top

- `top` ——（动态显示进程信息，退出q，一般3秒刷新一次）

6、du

- `du -sh 路径`——查看目录的真实大小。-s只显示汇总大小，-h高可读性显示

7、find

- `find  路径范围 选项-name 选项的值`——查找文件，支持模糊搜索
- `find  路径范围 选项-type 选项的值`——查找文件（-文件，这里需要用f替换，d文件夹）
>  whereis    查看文件的位置，Ubuntu没起作用，也许用法不对

>  locate     对文件名数据库进行检索查看文件位置 ,ubuntu下可用

8、kill

- `kill 进程PID`——根据pid杀死进程，配合ps使用。查到其PID。
- `killall 进程名称`

> kill杀死前台和后台的进程，而ctrl+c只能杀死正在运行的进程也就是前台进程

9、ifconfig

- `ifconfig`——获取网卡信息。2个网卡。Lo(loop)本地回环网卡,Inet 地址就是我们所说的ip地址

10、uptime

- `uptime`——输出计算机持续开机的时间,另外可以查看负载，不过最直接查看系统平均负载命令`cat /proc/loadavg`

        04:03:58 up 10 days, 13:19, 1 user, load average: 0.54, 0.40, 0.20
   - 当前时间 04:03:58
   - 系统已运行的时间 10 days, 13:19
   - 1 user当前在线用户数
   - 平均负载：0.54, 0.40, 0.20，最近1分钟、5分钟、15分钟系统的负载。其中负载就是在特定时间间隔内运行队列中的平均进程数。

11、uname

- `uname`——获取计算机操作系统信息
- `uname  -a`——获取全部信息

12、netstat

- `netstat -tnlp`——查看网络的连接状态。   
   - -t只列出TCP协议的连接，
   - -n将地址从字母组合转化为ip地址，将协议转化为端口号来显示（否则端口显示- ipp,smtp）
   - -l只显示state状态列中值为listen（正在监听）的连接
   - -p显示发起连接的进程的PID与名称
- `netstat -an`——查看网络的连接状态
   - -a表示全部
   - -n表示将字母转为数字
   
13、traceroute

- `traceroute 主机地址`——查找当前主机与目标主机之间所有的网关（就是路由器，会给沿途各个路由器发送icmp数据包，路由器可能不会响应）。该命令需要安装。

14、arp   
   地址解析协议，即ARP（Address Resolution Protocol）,是根据IP地址获取物理地址的一个TCP/IP协议(Mac地址)。主机发送信息时，首先检查本地是否有目标主机的MAC缓存，如果没有，就将包含目标IP地址的ARP请求广播到网络上的所有主机，拥有该IP地址的主机会响应，以此确定目标的物理地址；收到返回消息后将该IP地址和物理地址存入本机ARP缓存中并保留一定时间，下次请求时直接查询ARP缓存以节约资源。如果目标主机不在本地子网中，得到默认网关的MAC地址。
   - `arp -a`——查看本地缓存MAC表
   - `arp -d 主机地址`——删除缓存
   
15、tcpdump

- `tcpdump 协议 端口`——抓包，抓取数据表。输出`00:09:27.603075 IP 211.167.237.199.ssh > 221.216.165.189.1467: P 180400:180544(144) ack 2833 win 8576`,其中IP表示IP协议，211.167.237.199为数据包的来源或者方向，>表示数据的流向，221.216.165.189数据包的另外一个方向。
- `tcpdump 协议 端口 host 地址`——抓包，抓取数据表
- `tcpdump -i`——抓包，抓取数据表
   
   
## 答题：
- 如何在命令行中快速删除光标前后的内容？前：CTRL+U。后：CTRL+K
- 如何删除/tmp文件夹下所有A开头的文件？# rm  -f  /tmp/A*
- 统计系统有多少用户？# wc  -l  /etc/passwd(用户信息)
- 查看/etc的磁盘大小？#du  -sh  /etc
- fg：将后台中的命令调至前台继续运行。与配套：ctrl+z：可以将一个正在前台执行的命令放到后台，并且暂停。bg是将进程放到后台并唤醒
- awk -F ' ' '{print $3}' 指定空格是分隔符进行分割，取第三个。（不指定默认分隔符也是空格）
- uniq -c（uniq命令可以去除排序过的文件中的重复行，因此uniq经常和sort合用。也就是说，为了使uniq起作用，所有的重复行必须是相邻的。参数 - c ：进行计数）
- 缺省的Linux系统中，从后台启动进程，应在命令的结尾加上&符号。应用：redis集群时一次性开启6个服务不用开6个终端。
- 文件描述符是与某个打开的文件或数据流相关联的整数。在bash中，在一条命令后加入`1>&2`意味着标准输出重定向到标准错误输出
  - 0------------stdin（标准输入） 
  - 1------------stdout（标准输出）
  - 2------------stderr（标准错误）
  - '<'是输入重定向符
  - '>'是输出重定向符

## EXt2、Ext3
EXT2、EXT3：linux环境上的文件系统。ext2/ext3文件系统使用索引节点来记录文件信息，作用像windows的文件分配表。索引节点是一个结构，它包含了一个文件的长度、创建及修改时间、权限、所属关系、磁盘中的位置等信息。

EXT2、EXT3的区别如下：
1. ext2和ext3的格式完全相同，只是在ext3硬盘最后面有一部分空间用来存放Journal（日志）的记录；
2. 在ext2中，写资料到硬盘中时，先将资料写入缓存中，当缓存写满时才会写入硬盘中；
3. 在ext3中，写资料到硬盘中时，先将资料写入缓存中，鼗缓存写满时系统先通知Journal，再将资料写入硬盘，完成后再通知Journal，资料已完成写入工作；
4. 是否有Journal的差别：
   - 在ext2中，系统开机时会去检查有效位（Valid bit），如果值为1，表示系统上次有正常关机；如果为0，表示上次关机未正常关机，那系统就会从头检查硬盘中的资料，这样时间会很长；
   - 在ext3中，也就是有Journal机制里，系统开机时检查Journal的资料，来查看是否有错误产生，这样就快了很多；
   
 

## 内存屏障
1. [种类](https://my.oschina.net/u/269082/blog/873612/)
   - 写屏障：在写屏障之前的**所有写操作**指令都会在写屏障之后的**所有写操作**指令更早发生。
   - 读屏障：在读屏障之前的**所有读操作**指令都会在读屏障之后的**所有读操作**指令更早发生.
   - 通用屏障：在通用屏障之前的**所有写和读操作**指令都会在通用屏障之后的**所有写和读操作**指令更早发生。
   - 优化屏障：用于限制编译器的指令重排。
2. 配对的读/写屏障才能保证正确的程序行为。左图中，CPU2上观察到x值为2, 无法保证其观察到的y值为1。因为虽然a=1在b=2之前发生，但是有个前提**不保证内存屏障之前的内存操作在该内存屏障指令完成前完成，因为它保证的仅是相对顺序。**也就说有可能b=2结束了，a=1因为延迟等某些原因还没执行完。右图，加上读屏障后，先读b的值，接着读a的值，

   <img src="https://github.com/xuzhuang1996/MyJava/blob/master/img/linux/内存屏障1.png" width=45% height=45% /><img src="https://github.com/xuzhuang1996/MyJava/blob/master/img/linux/内存屏障2.png" width=45% height=45% />
   
   
## 软链接与硬链接
1. 在Linux的文件系统中，保存在磁盘分区中的文件不管是什么类型都给它分配一个编号，称为索引节点号inode。
2. 文件名和inode号码是”一一对应”关系，而不是文件与iNode一一对应。
2. 在Linux中，多个文件名指向同一索引节点是存在的。比如：A是B的硬链接（A和B都是文件名），则A的目录项中的inode节点号与B的目录项中的inode节点号相同，即一个inode节点对应两个不同的文件名，两个文件名指向同一个文件，A和B对文件系统来说是完全平等的。删除其中任何一个都不会影响另外一个的访问。硬链接不可以跨文件系统。它只能建立对文件的链接，硬链接的文件类型位是－
3. A是B的软链接（A和B都是文件名），A的目录项中的inode节点号与B的目录项中的inode节点号不相同，A和B指向的是两个不同的inode，继而指向两块不同的数据块。但是A的数据块中存放的只是B的路径名（可以根据这个找到B的目录项）。A和B之间是“主从”关系，如果B被删除了，A仍然存在（因为两个是不同的文件），但指向的是一个无效的链接。符号链接也叫软链接，可以跨文件系统。
## vim
![image text](https://github.com/xuzhuang1996/MyJava/blob/master/img/linux/vimtmp.png)
![image text](https://github.com/xuzhuang1996/MyJava/blob/master/img/linux/vimCommand.png)
![image text](https://github.com/xuzhuang1996/MyJava/blob/master/img/linux/vimEnd.png)
![image text](https://github.com/xuzhuang1996/MyJava/blob/master/img/linux/vimex.png)
